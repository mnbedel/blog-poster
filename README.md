# Blog Poster Application

Blog Poster is a blog application built in Go, using gRPC for client-server communication and MongoDB as the database. The app enables users to create, read, update, delete, and list blog posts.

## Table of Contents

- [Features](#features)
- [Installation](#installation)
- [Usage](#usage)
- [API](#api)
- [Directory Structure](#directory-structure)
- [Makefile Commands](#makefile-commands)
- [License](#license)

---

## Features

- **Create a Blog Post**: Add new blog posts to the database.
- **Read a Blog Post**: Retrieve details of a specific blog post by ID.
- **Update a Blog Post**: Modify the content of an existing blog post.
- **Delete a Blog Post**: Remove a blog post by ID.
- **List All Blog Posts**: Stream all available blog posts.

## Installation

### Prerequisites

- [Go](https://golang.org/dl/) (version 1.16+ recommended)
- [Docker](https://www.docker.com/)
- [Protocol Buffers Compiler (protoc)](https://grpc.io/docs/protoc-installation/)

### Clone the Repository

```bash
git clone https://github.com/mnbedel/blog-poster
cd blog-poster
```

### Install Dependencies

To install required Go dependencies:

```bash
go mod tidy
```

Ensure `protoc` is installed, and install the necessary Go plugins if needed:

```bash
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest
```

### Start MongoDB with Docker

A `docker-compose.yml` file is provided to start MongoDB and Mongo Express for managing the database.

1. Navigate to the `blog` folder:

   ```bash
   cd blog
   ```

2. Start MongoDB and Mongo Express:

   ```bash
   docker-compose up
   ```

   - MongoDB will be available on `localhost:27017`.
   - Mongo Express for MongoDB management will be available at [http://localhost:8081](http://localhost:8081).

To stop the services, press `Ctrl + C` in the terminal or use:

```bash
docker-compose down
```

## Usage

### Starting the Application

Using the `Makefile`, you can streamline setup and run processes.

1. **Generate gRPC code and Build the Application**:

   ```bash
   make all
   ```

   This command will:
   - Generate protobuf files for gRPC communication.
   - Build the server and client executables in the `bin/` directory.

2. **Run the Server**

   To start the gRPC server:

   ```bash
   ./bin/blog/server
   ```

3. **Run the Client**

   In a separate terminal, run the client:

   ```bash
   ./bin/blog/client
   ```

4. **Clean Up**

   To remove all generated files:

   ```bash
   make clean
   ```

5. **Rebuild**

   Clean and rebuild the entire project:

   ```bash
   make rebuild
   ```

## API

### gRPC Services

- **CreateBlog**: Create a new blog post. Accepts a `Blog` message and returns a `BlogId`.
- **ReadBlog**: Retrieve a blog post by ID. Accepts a `BlogId` message and returns a `Blog`.
- **UpdateBlog**: Update an existing blog post. Accepts a `Blog` message and returns an empty message.
- **DeleteBlog**: Delete a blog post by ID. Accepts a `BlogId` message and returns an empty message.
- **ListBlogs**: Stream all available blog posts. Takes an empty message and returns a stream of `Blog` messages.

## Directory Structure

```
blog-poster/
├── blog/
│   ├── proto/
│   │   └── blog.proto         # Protocol Buffers file
│   ├── client/
│   │   └── main.go            # Client code for gRPC methods
│   ├── server/
│   │   └── main.go            # Server code for handling gRPC requests
│   ├── docker-compose.yml     # Docker Compose file for MongoDB and Mongo Express
├── bin/                       # Compiled binaries (generated by Makefile)
├── Makefile                   # Makefile for build automation
├── README.md
└── go.mod                     # Go module file
```

## Makefile Commands

| Command      | Description                                |
|--------------|--------------------------------------------|
| `make all`   | Generate protobuf files and build binaries |
| `make clean` | Clean all generated files                  |
| `make rebuild` | Clean and rebuild the entire project     |
| `make bump`  | Update all package dependencies            |
| `make about` | Display environment and build information  |
| `make help`  | Display help for Makefile commands         |

## License

This project is licensed under the MIT License.